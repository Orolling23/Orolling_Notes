# 深入剖析Kubernetes



## 第一章 云原生发展



### 0 云计算的三种服务模式

**云计算的三种服务模式：IaaS、PaaS、SaaS**

IaaS： Infrastructure-as-a-Service（基础设施即服务）提供给客户的服务是对所有计算基础设施的利用，包括处理CPU、内存、存储、网络和其它基本的计算资源，用户能够部署和运行任意软件，包括操作系统和应用程序。

PaaS：Platform-as-a-Service（平台即服务）提供给客户的服务是把客户采用提供的开发语言和工具（例如Java，python, .Net等）开发的或收购的应用程序部署到供应商的云计算基础设施上去。客户不需要管理或控制底层的云基础设施，包括网络、服务器、操作系统、存储等，但客户能控制部署的应用程序，也可能控制运行应用程序的托管环境配置。

SaaS：Software-as-a-Service（软件即服务）提供给客户的服务是运营商运行在云计算基础设施上的应用程序，用户可以在各种设备上通过客户端界面访问，如浏览器。客户不需要管理或控制任何云计算基础设施，包括网络、服务器、操作系统、存储等等，软件的开发、管理、部署都交给第三方，不需要关心技术问题，可以拿来即用。

普通用户接触到互联网服务基本上都是SaaS，例如社交服务：如QQ、微信等软件。PaaS提供软件部署平台，抽象了硬件和操作系统的细节，可以无缝扩展，开发者只需要关注自己的业务逻辑，无需关注底层。IaaS是云服务的最底层，主要是提供一些基础资源，用户需要自己控制底层硬件和系统。阿里云提供的服务中包含IaaS、PaaS这两种。



### 1 容器技术发展历程

2013~2014年以**Cloud Foundry**为代表的PaaS项目逐渐开拓出市场，其**最核心的组件就是一套应用的打包和分发机制**。Cloud Foundry为每种主流编程语言定义了一种打包格式，用户可通过命令`cf push`把应用的可执行文件和启动脚本打包进一个压缩包内，上传到云上Cloud Foundry的存储中，Cloud Foundry会通过调度器选择一个可以运行这个应用的虚拟机，然后通过这个机器上的Agent下载并启动压缩包。

由于需要在一个虚拟机上启动多个来自不同用户的应用，Cloud Foundry会调用OS的**Namespace**和**Cgroups**机制为每一个应用单独创建一个**“沙盒”**的隔离环境，并在“沙盒”中启动对应的应用进程，从而达到多个用户的应用互不干扰地在虚拟机中批量地、自动地运行起来的目的。（*沙盒、容器，都是用来**运行应用的隔离环境***）

但Cloud Foundry存在着一个问题即：**应用“打包”困难**。**Docker项目的出现**近乎完美的解决了这个根本性问题，并快速占领云计算领域。Docker项目于Cloud Foundry的容器在大部分功能和实现原理上一样，Docker之所以能脱颖而出的功能即**Docker镜像**。

比PaaS的应用可执行文件+启停脚本的组合丰富的多，**Docker镜像是直接由一个完整的操作系统的所有文件和目录压缩构成**，这个压缩包中的环境与本地开发和测试的环境用的OS完全一致，故Docker解决了PaaS中应用打包困难这一根本性问题。

